#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Jul 10 15:58:34 2023
@author: sreekrishnaravishankar
"""
from CoolProp.CoolProp import PropsSI as cp
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import cm
from matplotlib.colors import LogNorm
from matplotlib import colors


P_lower = 1e5
P_upper = 100e5
data_samples = 500
T_lower = 15
T_upper = 800
Enthalpy_Matrix = np.zeros((data_samples, data_samples))
Viscosity_Matrix = np.zeros((data_samples, data_samples))
Rho_Matrix = np.zeros((data_samples, data_samples))
Thermal_Conductivity = np.zeros((data_samples, data_samples))
Therm_Table_noround = np.zeros((data_samples**2,6))
k=0


# Generate linearly spaced numbers
P_Matrix = np.linspace(P_lower, P_upper, data_samples)
T_Matrix = np.linspace(T_lower, T_upper, data_samples)

#Generate enthalphy and viscosity for the generated matrix
for i in range(len(P_Matrix)):
    for j in range((len(T_Matrix))):
        Enthalpy_Matrix[i,j] = cp('Hmass', 'P', P_Matrix[i], 'T', T_Matrix[j], 'Hydrogen')
        Viscosity_Matrix[i,j] = cp('V', 'P', P_Matrix[i], 'T', T_Matrix[j], 'Hydrogen')
        Rho_Matrix[i,j] = cp('D', 'P', P_Matrix[i], 'T', T_Matrix[j], 'Hydrogen')
        Thermal_Conductivity[i,j] = cp('L', 'P', P_Matrix[i], 'T', T_Matrix[j], 'Hydrogen')
        Therm_Table_noround[k] = [P_Matrix[i], T_Matrix[j], Rho_Matrix[i][j], Enthalpy_Matrix[i, j], Viscosity_Matrix[i,j],Thermal_Conductivity[i][j]]  # Assign values to Therm_Table
        k += 1  # Increment the index


P_column = Therm_Table_noround[:, 0]
T_column = Therm_Table_noround[:, 1]
Rho_column = Therm_Table_noround[:,2]
Enthalphy_column = Therm_Table_noround[:,3]
viscosity_column = Therm_Table_noround[:,4]
thermalConductivity_column = Therm_Table_noround[:,5]

custom_breakpoints = np.linspace(min(thermalConductivity_column),max(thermalConductivity_column),10)
cmap = plt.get_cmap('plasma')
norm = colors.BoundaryNorm(custom_breakpoints, cmap.N)

# Create the scatter plot with custom color map and norm
fig, ax = plt.subplots()
sc = ax.scatter(T_column, P_column, c=thermalConductivity_column, cmap=cmap, norm=norm)

# Set axis labels
ax.set_xlabel('Temperature (K)')
ax.set_ylabel('Pressure (Pa)')

# Add a colorbar to indicate density values
cbar = plt.colorbar(sc)
cbar.set_label('Thermal Conductivity (W/mK)')

# Show the plot
plt.show()
